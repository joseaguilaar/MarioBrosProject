# Mario Bros Project

**Project Title:** NL-Mario: Natural Language Driven Hybrid Level Generation
**Team:** Jose Aguilar (Leader), Jose Carral
**Date:** 29.12.2025

## 1. Abstract

This project presents a Procedural Content Generation (PCG) system for *Super Mario Bros* that combines the accessibility of Large Language Models (LLMs) with constructive and search algorithms. The main goal is to allow a user to describe a level using natural language (e.g., "I want a difficult maze full of enemies") and have the system translate this intention into technical parameters to generate playable, complex, and aesthetically coherent levels. The system uses a hybrid architecture that selects between different generation strategies ("Flow" vs. "Puzzle") and applies a final optimization phase to ensure playability.

## 2. Motivation & Background

Mario level generation usually faces two main problems: the lack of intuitive control for the user (adjusting numerical variables is tedious) and the difficulty of generating complex structures (such as lock-and-key puzzles) with purely random or simple evolutionary algorithms.
Our proposal innovates by introducing an "Intent Translation" layer using Generative AI, allowing for dynamic parameterization. Furthermore, we address design quality by separating generation into two specialized approaches (Rhythm vs. Logic) and refining them using search-based methods.

## 3. Project Goals

*
**Natural Language Interface:** Implement a module that uses generative AI to extract configuration parameters (JSON) from informal user descriptions.


* **Strategic Generation:** Develop two distinct generators specialized in opposite gameplay experiences: *FlowRunner* (speed and jumps) and *MazeMaster* (exploration and puzzles).
* **Structural Complexity:** Go beyond "running to the right" by implementing *Backtracking* mechanics and *Lock-and-Key* systems.
*
**Progressive Optimization:** Implement a repair and improvement system that takes the generated level (draft) and refines it using agent simulation.


* **Iterative Co-Creation Loop (Conversational Refinement):** Unlike traditional "black box" generators, our system will support a conversational refinement flow. The user can act as a creative director, providing feedback on the generated level (e.g., "There are too many gaps", "Make it a bit longer"). The LLM module will interpret these critiques to selectively adjust the current draft's parameters and regenerate it, allowing for guided content evolution without discarding the base structure.

## 4. Methodology

The generator workflow ("The Pipeline") consists of three sequential phases:

### Phase 1: Intent Extraction (LLM Layer)

The user inputs descriptive text. The system connects to a Generative AI API to map the text to a predefined set of parameters, ignoring irrelevant information. Controllable parameters include:

* `generationStrategy`: Algorithm selection (Flow vs. Puzzle).
* `difficulty`, `enemyDensity`, `coinDensity`: Normalized values [0, 1].
* `puzzleComplexity`: Depth level of the mission graph.
* `verticality`: Control of terrain topography.

### Phase 2: Constructive Generation (The Draft)

Depending on the `generationStrategy` parameter, one of two constructive algorithms is instantiated:

* **Strategy A: "The FlowRunner" (Physics-Based Cursor):** Focused on rhythm and *speedrunning*. It uses a "physics cursor" algorithm that projects Mario's jump parabola to place platforms, ensuring movement flow is never interrupted. Decoration (coins, enemies) is placed following jump arcs.
* **Strategy B: "The MazeMaster" (Graph & Chunks):** Focused on logic. First, it generates an abstract mission graph (e.g., Start -> Key -> Door -> Goal). Subsequently, it assembles the level using "Chunks" (pre-designed or procedural level fragments) to materialize blocking structures and ensure the key is always reachable before the door.

### Phase 3: Progressive Optimization (Search-Based)

Once the draft is generated, an iterative improvement process applies:

1. **Validation:** An A* agent (modified to understand puzzle states) is used to simulate the level.
2. **Repair:** If the agent fails or "frustration" zones are detected (impossible jumps, absurd difficulty spikes), local mutations (*Search-based repair*) are applied to correct geometry or enemy density.

## 5. Expected Deliverables

* A repository with Java source code, integrated into the *Mario AI Framework*.
* Technical documentation detailing the algorithms for *FlowRunner* and *MazeMaster* strategies.
*
**Comparative Study:** A final report including an experiment comparing the quality of levels generated by our hybrid method versus levels generated purely by generative AI (Baseline), demonstrating the advantages of the proposed architecture in terms of playability and structural coherence.



## 6. Bibliography / Resources

*
*Mario AI Framework* (Repository).


* Resources on *Grammar-Based Level Generation* (for MazeMaster).
* Documentation on *Large Language Models for Intent Classification*.